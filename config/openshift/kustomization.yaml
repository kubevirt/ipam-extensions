# Adds namespace to all resources.
namespace: openshift-kubevirt-ipam-controller-system

# Value of this field is prepended to the
# names of all resources, e.g. a deployment named
# "wordpress" becomes "alices-wordpress".
# Note that it should also match with the prefix (text before '-') of the namespace
# field above.
namePrefix: kubevirt-ipam-controller-

labels:
- includeSelectors: true
  pairs:
    app: ipam-virt-workloads

resources:
- ../rbac
- ../manager
- ../webhook

patches:
- path: manager_webhook_patch.yaml
- path: webhookcainjection_patch.yaml
- patch: |-
    - op: add
      path: /webhooks/0/objectSelector
      value:
        matchLabels:
          kubevirt.io: virt-launcher
  target:
    kind: MutatingWebhookConfiguration
    group: admissionregistration.k8s.io
    version: v1
    name: mutating-webhook-configuration
- patch: |-
    - op: add
      path: /metadata/annotations
      value:
        service.beta.openshift.io/serving-cert-secret-name: webhook-service
  target:
    kind: Service
    version: v1
    name: webhook-service
